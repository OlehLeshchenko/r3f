import{O as x,B as p,D as l,d as g,f as T,b as u,a as m,g as _,m as w,e as v}from"./index-DAa9yKAB.js";const y=p(14);class f extends x{async _redrawText(e,t,i){const s=this.getObject(),a=this.getPadPainter(),o=this.getFramePainter(),n=s.fName.startsWith("http://")||s.fName.startsWith("https://");let d=1,r=!1;this.createAttText({attr:s}),i==="3d"||s.TestBit(y)?this.isndc=!0:!i&&a?.getRootPad(!0)?r=new l(this.getDrawOpt()).check("FRAME"):i||(this.isndc=!0,e=t=.5,s.fTextAlign=22);const h=this.createG(r?"frame2d":void 0,n);h.attr("transform",null),e=this.axisToSvg("x",e,this.isndc),t=this.axisToSvg("y",t,this.isndc),this.swap_xy=r&&o?.swap_xy(),this.swap_xy&&([e,t]=[t,e]);const c=this.textatt.createArg({x:e,y:t,text:s.fTitle,latex:0});return this.matchObjectType(g)||i?c.latex=1:this.matchObjectType(T)&&(c.latex=2,d=.8),n&&(h.attr("href",s.fName),this.isBatchMode()||h.append("svg:title").text(`link on ${s.fName}`)),this.startTextDrawingAsync(this.textatt.font,this.textatt.getSize(a,d)).then(()=>this.drawText(c)).then(()=>this.finishTextDrawing()).then(()=>this.isBatchMode()?this:a.isButton()&&!a.isEditable()?(h.on("click",()=>this.getCanvPainter().selectActivePad(a)),this):(Object.assign(this,{pos_x:e,pos_y:t,pos_dx:0,pos_dy:0}),i!=="3d"&&u(this,!0,n),m(this),this.matchObjectType(_)&&h.style("cursor","pointer").on("click",()=>this.submitCanvExec("ExecuteEvent(kButton1Up, 0, 0);;")),this))}async redraw(){return this._redrawText(this.getObject().fX,this.getObject().fY)}moveDrag(e,t){this.pos_dx+=e,this.pos_dy+=t,w(this.getG(),this.pos_dx,this.pos_dy)}moveEnd(e){if(e)return;const t=this.getObject();let i=this.svgToAxis("x",this.pos_x+this.pos_dx,this.isndc),s=this.svgToAxis("y",this.pos_y+this.pos_dy,this.isndc);this.swap_xy&&([i,s]=[s,i]),t.fX=i,t.fY=s,this.submitCanvExec(`SetX(${i});;SetY(${s});;`)}fillContextMenuItems(e){const t=this.getObject();e.add("Change text",()=>e.input("Enter new text",t.fTitle).then(i=>{t.fTitle=i,this.interactiveRedraw("pad",`exec:SetTitle("${i}")`)}))}static async draw(e,t,i){const s=new f(e,t,i);return v(s,!1).then(()=>s.redraw())}}export{f as TTextPainter};
