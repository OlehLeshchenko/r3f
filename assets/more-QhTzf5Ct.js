import{m as v,a as X,b as Y,B as R,D as O,c as b}from"./index-DAa9yKAB.js";function E(){const t=this.getObject(),a=t.fPhimin===0&&t.fPhimax===360,l=t._typename==="TCrown";this.createAttLine({attr:t}),this.createAttFill({attr:t});const d=this.createG(),s=this.getAxisToSvgFunc(),n=s.x(t.fX1),o=s.y(t.fY1),c=l&&t.fR1<=0?s.x(t.fX1+t.fR2)-n:s.x(t.fX1+t.fR1)-n,f=o-s.y(t.fY1+t.fR2),r=Math.PI/180;let e="";if(l&&t.fR1>0){const h=t.fYXRatio??1,i=c,x=h*f,$=h*(o-s.y(t.fY1+t.fR1)),y=s.x(t.fX1+t.fR2)-n;if(a)e=`M${-i},0A${i},${$},0,1,0,${i},0A${i},${$},0,1,0,${-i},0M${-y},0A${y},${x},0,1,0,${y},0A${y},${x},0,1,0,${-y},0`;else{const A=t.fPhimax-t.fPhimin>=180?1:0,g=t.fPhimin*r,u=t.fPhimax*r,p=Math.round(i*Math.cos(g)),T=Math.round($*Math.sin(g)),P=Math.round(i*Math.cos(u)),S=Math.round($*Math.sin(u)),M=Math.round(y*Math.cos(g)),m=Math.round(x*Math.sin(g)),w=Math.round(y*Math.cos(u)),k=Math.round(x*Math.sin(u));e=`M${P},${S}A${i},${$},0,${A},0,${p},${T}L${M},${m}A${y},${x},0,${A},1,${w},${k}Z`}}else if(t.fTheta===0)if(a)e=`M${-c},0A${c},${f},0,1,0,${c},0A${c},${f},0,1,0,${-c},0Z`;else{const h=Math.round(c*Math.cos(t.fPhimin*r)),i=Math.round(f*Math.sin(t.fPhimin*r)),x=Math.round(c*Math.cos(t.fPhimax*r)),$=Math.round(f*Math.sin(t.fPhimax*r));e=`M0,0L${h},${i}A${c},${f},0,1,1,${x},${$}Z`}else{const h=Math.cos(t.fTheta*r),i=Math.sin(t.fTheta*r),x=t.fPhimin*r,$=t.fPhimax*r,y=200,A=($-x)/(y-(a?0:1));let g=0,u=0;a||(e="M0,0");for(let p=0;p<y;++p){const T=x+p*A,P=t.fR1*Math.cos(T),S=t.fR2*Math.sin(T),M=s.x(t.fX1+P*h-S*i)-n,m=s.y(t.fY1+P*i+S*h)-o;e?g===M?e+=`v${m-u}`:u===m?e+=`h${M-g}`:e+=`l${M-g},${m-u}`:e=`M${M},${m}`,g=M,u=m}e+="Z"}this.x=n,this.y=o,v(d.append("svg:path"),n,o).attr("d",e).call(this.lineatt.func).call(this.fillatt.func),X(this),Y(this),this.moveDrag=function(h,i){this.x+=h,this.y+=i,v(this.getG().select("path"),this.x,this.y)},this.moveEnd=function(h){if(h)return;const i=this.getObject();i.fX1=this.svgToAxis("x",this.x),i.fY1=this.svgToAxis("y",this.y),this.submitCanvExec(`SetX1(${i.fX1});;SetY1(${i.fY1});;Notify();;`)}}function D(){const t=this.createG(),a=this.getObject(),l=a.fPieSlices.length,d=this.axisToSvg("x",a.fX),s=this.axisToSvg("y",a.fY),n=this.axisToSvg("x",a.fX+a.fRadius)-d,o=this.axisToSvg("y",a.fY+a.fRadius)-s;v(t,d,s);let c=0,f=a.fAngularOffset*Math.PI/180,r=Math.round(n*Math.cos(f)),e=Math.round(o*Math.sin(f));for(let h=0;h<l;h++)c+=a.fPieSlices[h].fValue;for(let h=0;h<l;h++){const i=a.fPieSlices[h];this.createAttLine({attr:i}),this.createAttFill({attr:i}),f+=i.fValue/c*2*Math.PI;const x=Math.round(n*Math.cos(f)),$=Math.round(o*Math.sin(f));t.append("svg:path").attr("d",`M0,0L${r},${e}A${n},${o},0,0,0,${x},${$}z`).call(this.lineatt.func).call(this.fillatt.func),r=x,e=$}}function N(){const t=this.getObject(),a=R(14);this.isndc=t.TestBit(a);const l=new O(this.getDrawOpt()),d=this.isndc?!1:l.check("FRAME"),s=d&&this.getFramePainter()?.swap_xy();this.createAttMarker({attr:t});const n=this.createG(d?"frame2d":void 0);let o=this.axisToSvg("x",t.fX,this.isndc),c=this.axisToSvg("y",t.fY,this.isndc);s&&([o,c]=[c,o]);const f=this.markeratt.create(o,c);f&&n.append("svg:path").attr("d",f).call(this.markeratt.func),!l.check("NO_INTERACTIVE")&&(X(this),Y(this),this.dx=this.dy=0,this.moveDrag=function(r,e){this.dx+=r,this.dy+=e,this.getG()&&v(this.getG().select("path"),this.dx,this.dy)},this.moveEnd=function(r){if(r||!this.getG())return;const e=this.getObject();let h=this.svgToAxis("x",this.axisToSvg("x",e.fX,this.isndc)+this.dx,this.isndc),i=this.svgToAxis("y",this.axisToSvg("y",e.fY,this.isndc)+this.dy,this.isndc);s&&([h,i]=[i,h]),e.fX=h,e.fY=i,this.submitCanvExec(`SetX(${h});;SetY(${i});;Notify();;`),this.redraw()})}function _(){const t=this.getObject(),a=this.getAxisToSvgFunc();this.createAttMarker({attr:t});const l=this.createG();let d="";for(let s=0;s<=t.fLastPoint;++s)d+=this.markeratt.create(a.x(t.fX[s]),a.y(t.fY[s]));d&&l.append("svg:path").attr("d",d).call(this.markeratt.func),X(this),Y(this),this.dx=this.dy=0,this.moveDrag=function(s,n){this.dx+=s,this.dy+=n,this.getG()&&v(this.getG().select("path"),this.dx,this.dy)},this.moveEnd=function(s){if(s||!this.getG())return;const n=this.getObject(),o=this.getAxisToSvgFunc();let c="";for(let f=0;f<=n.fLastPoint;++f){const r=this.svgToAxis("x",o.x(n.fX[f])+this.dx),e=this.svgToAxis("y",o.y(n.fY[f])+this.dy);n.fX[f]=r,n.fY[f]=e,c+=`SetPoint(${f},${r},${e});;`}this.submitCanvExec(c+"Notify();;"),this.redraw()}}function C(t,a,l){const d=new b(t),s=d.selectDom(),n=s.append("img").attr("src",a.fName).attr("title",a.fTitle||a.fName);return l&&l.indexOf("scale")>=0?n.style("width","100%").style("height","100%"):l&&l.indexOf("center")>=0&&(s.style("position","relative"),n.attr("style","margin: 0; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);")),d.setTopPainter(),d}export{E as drawEllipse,C as drawJSImage,N as drawMarker,D as drawPie,_ as drawPolyMarker};
